<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Äiá»ƒm danh cÃ´ng Ä‘á»©c</title>
  <style>
    body {
      background: #fdf8f2;
      font-family: 'Times New Roman', serif;
      color: #3c2e1f;
      padding: 30px;
      line-height: 1.6;
    }
    h1 {
      text-align: center;
      color: #6b4b2c;
    }
    button {
      display: block;
      margin: 20px auto;
      padding: 12px 28px;
      font-size: 1rem;
      background: #a7895c;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background: #927148;
    }
    .result {
      margin-top: 30px;
      padding: 20px;
      background: #fff7e6;
      border: 1px solid #e0d2b5;
      border-radius: 12px;
    }
    .back-link {
      display: block;
      text-align: center;
      margin-top: 40px;
      font-size: 0.95rem;
      color: #5a3c20;
      text-decoration: none;
    }
  </style>
</head>
<body>

  <h1>Äiá»ƒm danh cÃ´ng Ä‘á»©c hÃ´m nay</h1>

  <button onclick="diemDanh()">HÃ´m nay con Ä‘Ã£ vÃ o chÃ¹a</button>

  <div class="result" id="result"></div>

  <a class="back-link" href="index.html">â† Trá»Ÿ vá» Trang chá»§</a>

  <script>
    const ngayTotXau = [
      "HÃ´m nay lÃ  ngÃ y tá»‘t Ä‘á»ƒ tu tÃ¢m dÆ°á»¡ng tÃ­nh.",
      "NgÃ y Ä‘áº¹p Ä‘á»ƒ gieo thiá»‡n duyÃªn, giá»¯ tÃ¢m an.",
      "HÃ´m nay tÃ¢m Ä‘á»™ng, nÃªn thiá»n Ä‘á»‹nh vÃ  tÄ©nh láº·ng.",
      "NgÃ y cÃ³ duyÃªn lÃ nh, nÃªn lÃ m viá»‡c thiá»‡n.",
      "HÃ´m nay trÃ¡nh nÃ³ng giáº­n, giá»¯ lÃ²ng tá»« bi.",
      "NgÃ y nÃ y há»£p tá»¥ng kinh niá»‡m Pháº­t, trÃ¡nh thá»‹ phi."
    ];

    const keNgay = [
      "TÃ¢m tá»‹nh nhÆ° nÆ°á»›c láº·ng.",
      "Giá»¯ lÃ²ng hiá»n, phÆ°á»›c Ä‘á»©c tá»± sinh.",
      "Má»™t niá»‡m thiá»‡n, váº¡n Ã¡c tiÃªu tan.",
      "CÃ´ng Ä‘á»©c nhá», tÃ­ch láº¡i thÃ nh lá»›n.",
      "TÃ¢m sÃ¡ng thÃ¬ Ä‘Æ°á»ng sÃ¡ng.",
      "BuÃ´ng xáº£ lÃ  háº¡nh phÃºc.",
      "HÃ nh thiá»‡n khÃ´ng cáº§n ai biáº¿t."
    ];

    function getDateString(d) {
      return d.toISOString().split('T')[0];
    }

   function diemDanh() {
  const ten = localStorage.getItem("tenPhapDanh");
  if (!ten) {
    alert("Vui lÃ²ng quay láº¡i trang chá»§ vÃ  nháº­p Há» tÃªn hoáº·c PhÃ¡p danh trÆ°á»›c khi Ä‘iá»ƒm danh.");
    return;
  }

  const now = new Date();
  const todayStr = getDateString(now);
  const gio = now.toLocaleTimeString('vi-VN');

  const lastDateStr = localStorage.getItem('diemdanh-ngay');
  let streak = parseInt(localStorage.getItem('diemdanh-streak')) || 0;

  if (lastDateStr) {
    const lastDate = new Date(lastDateStr);
    const diff = Math.floor((now - lastDate) / (1000 * 60 * 60 * 24));

    if (diff === 1) {
      streak += 1;
    } else if (diff > 1) {
      streak = 1;
    }
  } else {
    streak = 1;
  }

  localStorage.setItem('diemdanh-ngay', todayStr);
  localStorage.setItem('diemdanh-gio', gio);
  localStorage.setItem('diemdanh-streak', streak);

  const totxau = ngayTotXau[Math.floor(Math.random() * ngayTotXau.length)];
  const ke = keNgay[Math.floor(Math.random() * keNgay.length)];

  document.getElementById("result").innerHTML = `
    <p>ğŸ™ PhÃ¡p danh: <strong>${ten}</strong></p>
    <p>â° Giá» Ä‘iá»ƒm danh: <strong>${gio}</strong> â€“ NgÃ y: <strong>${todayStr}</strong></p>
    <p>ğŸ“œ ${totxau}</p>
    <p>ğŸ’¡ CÃ¢u ká»‡ hÃ´m nay: <em>"${ke}"</em></p>
    <p>ğŸ”¥ Chuá»—i Ä‘iá»ƒm danh liÃªn tá»¥c: <strong>${streak} ngÃ y</strong></p>
  `;
}

    window.onload = () => {
      const ngay = localStorage.getItem('diemdanh-ngay');
      const gio = localStorage.getItem('diemdanh-gio');
      const streak = localStorage.getItem('diemdanh-streak') || 0;

      if (ngay && gio) {
        document.getElementById("result").innerHTML = `
          <p>â° Láº§n gáº§n nháº¥t Ä‘iá»ƒm danh: <strong>${gio}</strong> â€“ NgÃ y: <strong>${ngay}</strong></p>
          <p>ğŸ”¥ Chuá»—i Ä‘iá»ƒm danh hiá»‡n táº¡i: <strong>${streak} ngÃ y</strong></p>
          <p>ğŸ™ HÃ£y tiáº¿p tá»¥c duy trÃ¬ cÃ´ng Ä‘á»©c má»—i ngÃ y.</p>
        `;
      }
    };
  </script>
</body>
</html>
